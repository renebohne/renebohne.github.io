<!DOCTYPE html>
<html lang=en>
<head>
<meta charset=utf-8>
<title>Scanissimo Duck</title>
<script src="https://cdn.rawgit.com/mrdoob/three.js/r84/build/three.min.js"></script>
<script src="https://cdn.rawgit.com/mrdoob/three.js/r84/examples/js/loaders/STLLoader.js"></script>
<script src="altspace.min.js"></script>
</head>
<body>
</body>
<script>
if (!window.altspace || !window.altspace.inClient) {
	document.write('<h3>To view this example, please open this page in <a href="http://altvr.com"> AltspaceVR </a></h3>');
}

	var duck;

	var scene = new Three.Scene();
	var renderer = altspace.getThreeJSRenderer({version:'0.2.0'});

	var material;



	function loadDuckModel() {
		var loader = new THREE.STLLoader();
		var stlFilename = "duck_simple.stl";
		loader.load(stlFilename, function ( obj ) {

			if (obj.hasColors)
			{
				material = new THREE.MeshPhongMaterial({ opacity: geometry.alpha, vertexColors: THREE.VertexColors });
			} else {
				material = new THREE.MeshBasicMaterial({color: 0x00ff00});
			}

			duck = new THREE.Mesh(obj, material);
			scene.add(duck);
			render();
		});
	}
	loadDuckModel();

	if (altspace.inClient) {
		altspace.getEnclosure()
		.then(function (enclosure)
		{
			scene.position.y -= enclosure.innerHeight / enclosure.pixelsPerMeter / 3;
			duck.scale.multiplyScalar(enclosure.pixelsPerMeter / 80);
		});
	}


	//Update & Rendering
	function render() {
		requestAnimationFrame(render);

		duck.rotation.x += 0.01;
		duck.rotation.y += 0.01;

		renderer.render(scene);
	}



</script>
</html>
